pipeline {

    agent any

    stages {
       stage('Print Node Name') {
            steps {
                 script {
                    def instanceId = sh(script: 'curl -s http://169.254.169.254/latest/meta-data/instance-id', returnStdout: true).trim()
                    echo "Instance ID: ${instanceId}"
                 }
            }
        }
        stage('Assume Role') {
            steps {
                script {
                    ASSUME_ROLE_ARN='arn:aws:iam::175222917203:role/AmazonSSMManagedInstanceRole'
                    TEMP_ROLE = sh (
                        script: "aws sts assume-role --role-arn ${ASSUME_ROLE_ARN} --role-session-name jenkins-dev",
                        returnStdout: true
                        ).trim()
                    TEMP_ROLE = readJSON text: "${TEMP_ROLE}"
                }
            }
        }
    }
}
